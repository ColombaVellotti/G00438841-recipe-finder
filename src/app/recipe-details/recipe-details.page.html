<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>

    <ion-title>Recipe Details</ion-title>

    <ion-buttons slot="end">
      <ion-button (click)="toggleFavourite()" [disabled]="!recipeId">
        <ion-icon
          [name]="isFavourite ? 'heart' : 'heart-outline'"
          slot="start"
        ></ion-icon>
    {{ isFavourite ? 'Remove from Favourites' : 'Add to Favourites' }}
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <p *ngIf="errorMsg" style="color: red;">
    <b>Error:</b> {{ errorMsg }}
  </p>

  <div *ngIf="recipe">
    <h2>{{ recipe.title }}</h2>

    <!-- Unit system indicator -->
    <p style="color: #666; font-size: 14px; margin-top: -6px;">
      Units: <b>{{ unitSystem === 'metric' ? 'Metric' : 'US' }}</b>
    </p>

    <img
      *ngIf="recipe.image"
      [src]="recipe.image"
      [alt]="recipe.title"
      style="max-width: 100%; border-radius: 8px;"
    />

    <h3>Ingredients</h3>

    <ion-list *ngIf="ingredients.length">
      <ion-item *ngFor="let ing of ingredients">
        <ion-thumbnail slot="start" *ngIf="getIngredientImageUrl(ing)">
          <ion-img [src]="getIngredientImageUrl(ing)"></ion-img>
        </ion-thumbnail>

        <ion-label>
          {{ getIngredientLine(ing) }}
        </ion-label>
      </ion-item>
    </ion-list>

    <p *ngIf="!ingredients.length && !errorMsg">
      No ingredients found in response.
    </p>

    <h3>Instructions</h3>

    <ion-list *ngIf="steps.length">
      <ion-item *ngFor="let s of steps; let i = index">
        <ion-label>
          <b>Step {{ i + 1 }}:</b> {{ s }}
        </ion-label>
      </ion-item>
    </ion-list>

    <p *ngIf="!steps.length">
      No instructions available for this recipe.
    </p>
  </div>

  <p *ngIf="!recipe && !errorMsg">
    Loading...
  </p>
</ion-content>
